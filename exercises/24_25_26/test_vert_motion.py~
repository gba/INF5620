import vertical_motion as vm
import nose.tools as nt
import numpy as np

def test_heavy_slow():
    #
    # Assumption: density of body is very large,
    #            density of medium is very small.
    #            This should give linear velocity
    #            according to v(t) = v0 - g*t.
    #
    g = 9.81
    v0 = 0.0
    #     Solve numerically
    v, t = vm.solver(v0, a_s=0.0, a_q=0.0, b=-g, \
                      Re_const=0.0, T=2.0, dt=0.001)
    
    v_a = np.zeros(len(t))
    #     The analytic velocity
    for n in range(0, len(t)):
        v_a[n] = v0 - g*t[n]
        
    diff = np.abs(v-v_a).max()
    nt.assert_almost_equal(diff, 0, delta=1E-3)
